// Generated by CoffeeScript 1.4.0
(function(){window.requestAnimFrame=function(e){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)}}();window.d2r=.0174532925;window.logged={};window.log=function(e){if(!window.logged[e]){console.log(e);return window.logged[e]=!0}};window.Collision=function(){function e(e,t){var n,r,i,s,o,u;this.collider=e;this.target=t;i=this.collider.position;r=this.collider.dimensions;u=this.target.position;o=this.target.dimensions;n={top:i.y-r.h/2,bottom:i.y+r.h/2,right:i.x+r.w/2,left:i.x-r.w/2};s={top:u.y-o.h/2,bottom:u.y+o.h/2,right:u.x+o.w/2,left:u.x-o.w/2};this.collided=!1;n.top<s.bottom&&n.bottom>s.top&&n.left<s.right&&n.right>s.left&&(this.collided=!0)}return e}();window.World=function(){function e(e){this.type=e;this.size={x:0,y:0};this.bodies=[]}e.prototype.createBody=function(e){e.parent=this;return this.bodies.push(e)};e.prototype.step=function(){var e,t,n,r,i;r=this.bodies;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e.alive?i.push(this.move(e)):i.push(void 0)}return i};e.prototype.move=function(e){var t,n,r,i,s,o;if(e.type==="static")return;typeof e.onMove=="function"&&e.onMove();e.position.y+=Math.sin(e.angle)*e.forces.y;e.position.x+=Math.cos(e.angle)*e.forces.y;e.angle+=e.forces.s;e.userData==="player"&&(e.forces.s=0);s=this.bodies;o=[];for(r=0,i=s.length;r<i;r++){n=s[r];if(n.id===e.id||!n.alive)continue;t=new Collision(e,n);if(t.collided){typeof n.onCollision=="function"&&n.onCollision(e);typeof e.onCollision=="function"?o.push(e.onCollision(n)):o.push(void 0)}else o.push(void 0)}return o};return e}();window.Keys=function(){function e(){this.up=!1;this.down=!1;this.left=!1;this.right=!1;this.space=!1;this.commands={37:"left",38:"up",39:"right",40:"down",32:"space"};this.loadEvents()}e.prototype.loadEvents=function(){var e=this;return $(window).bind("keydown keyup",function(t){if(e.commands.hasOwnProperty(t.keyCode))return e[e.commands[t.keyCode]]=t.type==="keydown"})};return e}();window.Assets=function(){function e(e){this.arr=e;this.asset={};this.loaded=0}e.prototype.load=function(e){var t,n,r,i,s,o=this;if(this.arr.length===0||!this.assets){e();return}i=this.arr;s=[];for(n=0,r=i.length;n<r;n++){t=i[n];this.asset[t]=new Image;this.asset[t].onload=function(){o.loaded++;if(o.loaded===o.arr.length)return e()};s.push(this.asset[t].src=t)}return s};return e}();window.Camera=function(){function e(e){this.canvas=e;this.ctx=this.canvas.getContext("2d");this.position={x:0,y:0};this.translation={x:0,y:0};this.scale=64;this.angle=Math.PI/4;this.loadEvents()}e.prototype.move=function(){this.position.x+=this.translation.x;this.position.y+=this.translation.y;return this.ctx.translate(this.position.x,this.position.y)};e.prototype.loadEvents=function(){var e=this;window.addEventListener("mousemove",function(t){t.offsetX<50?e.translation.x=10:t.offsetX>e.canvas.width-50?e.translation.x=-10:e.translation.x=0;return t.offsetY<50?e.translation.y=10:t.offsetY>e.canvas.height-50?e.translation.y=-10:e.translation.y=0});return window.addEventListener("mouseout",function(){e.translation.y=0;return e.translation.x=0})};return e}();window.Debugger=function(){function e(e){this.world=e}e.prototype.render=function(e){var t;t=e.canvas;e.save();e.fillStyle="rgba(0, 0, 0, 0.2)";e.fillRect(0,0,t.width,t.height);return e.restore()};return e}();window.Body=function(){function e(){this.id=Math.floor(Math.random()*0x2540bf5492d5bc0).toString(16);this.position={x:0,y:0,z:0};this.forces={x:0,y:0,z:0,s:0};this.dimensions={w:0,d:0,h:0};this.angle=0;this.fixtures=[];this.alive=!0;this.type="static";this.onMove=!1;this.onCollision=!1}e.prototype.createFixture=function(e){e.parent=this;return this.fixtures.push(e)};return e}();window.Fixture=function(){function e(){this.id=Math.floor(Math.random()*0x2540bf5492d5bc0).toString(16);this.position={x:0,y:0,z:0};this.dimensions={w:0,d:0,h:0};this.angle=0;this.onCollision=!1}e.prototype.angleFromBodyCenter=function(){return Math.atan(this.position.y/this.position.x)};e.prototype.radiusToBodyCenter=function(){var e,t;e=Math.pow(this.position.x,2);t=Math.pow(this.position.y,2);return Math.sqrt(e+t)};e.prototype.detach=function(){var e,t,n;t=new Body;t.type="dynamic";t.userData="fake";t.angle=this.parent.angle+this.angle;n=this.radiusToBodyCenter();e=this.angleFromBodyCenter();t.position={x:this.parent.position.x+n*Math.cos(t.angle+e),y:this.parent.position.y+n*Math.sin(t.angle+e)};log(e/d2r);t.dimensions=this.dimensions;return this.parent.parent.createBody(t)};return e}()}).call(this);